configurations.all {
    resolutionStrategy {
        eachDependency { DependencyResolveDetails det ->
            /* JAR upgrades with latest versions for CVE fixes*/

            /*
            * CVE-2022-29885
            * */
            if (det.requested.name == 'tomcat-embed-core') {
                det.useVersion '9.0.69'
            }

            if (det.requested.name == 'tomcat-embed-websocket') {
                det.useVersion '9.0.69'
            }

            /*
                CVE-2018-10237
            * */
            if (det.requested.name == 'guava') {
                det.useVersion '30.1-jre'
            }

            /*
                CVE-2020-13956
            * */
            if (det.requested.name == 'httpclient') {
                det.useVersion '4.5.13'
            }

            /* latest version CVE fix ends here */

            /* CVE-2021-28170 */
            if (det.requested.name == 'jakarta.el') {
                det.useVersion '4.0.1'
            }

            /*
                CVE-2021-28165, CVE-2021-28163, CVE-2021-28164, CVE-2021-28165, CVE-2021-28169, CVE-2021-34429
            * */
            if (det.requested.name == 'jetty-client' || det.requested.name == 'jetty-continuation' || det.requested.name == 'jetty-http'
                    || det.requested.name == 'jetty-security' || det.requested.name == 'jetty-servlet' || det.requested.name == 'jetty-servlets'
                    || det.requested.name == 'jetty-util' || det.requested.name == 'jetty-webapp' || det.requested.name == 'jetty-xml'
                    || det.requested.name == 'jetty-server' || det.requested.name == 'jetty-_http_server' || det.requested.name == 'jetty-util-ajax'
                    || det.requested.name == 'mortbay_jetty' || det.requested.name == 'jetty-io') {
                det.useVersion '9.4.43.v20210629'
            }

            /* CVE-2021-29425 */
            if (det.requested.name == 'commons-io') {
                det.useVersion '2.8.0'
            }

            /*
                 Prototype pollution Vulnerability
            * */
            if (det.requested.name == 'handlebars') {
                det.useVersion '4.2.0'
            }

            /* CVE-2022-21724 */
            if (det.requested.name == 'postgresql' && det.requested.group == 'org.postgresql') {
                det.useVersion '42.3.3'
            }

             /* CVE-2017-18640, CVE-2022-41854 */
            if(det.requested.name == 'snakeyaml'){
                det.useVersion '1.32'
            }

            /*
            * CVE-2023-24998
            * */
            if (det.requested.name == 'commons-fileupload') {
                det.useVersion '1.5'
            }

            /*
               CVE-2022-2048, CVE-2022-2047
            * */
            if (det.requested.name == 'jetty-client') {
                det.useVersion '9.4.51.v20230217'
            }

            /*
              CVE-2022-2048, CVE-2022-2047
            * */
            if (det.requested.name == 'jetty-continuation') {
                det.useVersion '9.4.51.v20230217'
            }

            /*
              CVE-2022-2048, CVE-2022-2047
            * */
            if (det.requested.name == 'jetty-http') {
                det.useVersion '9.4.51.v20230217'
            }

            /*
              CVE-2022-2048, CVE-2022-2047
            * */
            if (det.requested.name == 'jetty-io') {
                det.useVersion '9.4.51.v20230217'
            }

            /*
              CVE-2022-2048, CVE-2022-2047
            * */
            if (det.requested.name == 'jetty-security') {
                det.useVersion '9.4.51.v20230217'
            }

            /*
              CVE-2022-2048, CVE-2022-2047
            * */
            if (det.requested.name == 'jetty-server') {
                det.useVersion '9.4.51.v20230217'
            }

            /*
              CVE-2022-2048, CVE-2022-2047
            * */
            if (det.requested.name == 'jetty-servlet') {
                det.useVersion '9.4.51.v20230217'
            }

            /*
              CVE-2022-2048, CVE-2022-2047
            * */
            if (det.requested.name == 'jetty-servlets') {
                det.useVersion '9.4.51.v20230217'
            }

            /*
              CVE-2022-2048, CVE-2022-2047
            * */
            if (det.requested.name == 'jetty-util') {
                det.useVersion '9.4.51.v20230217'
            }

            /*
              CVE-2022-2048, CVE-2022-2047
            * */
            if (det.requested.name == 'jetty-util-ajax') {
                det.useVersion '9.4.51.v20230217'
            }

            /*
              CVE-2022-2048, CVE-2022-2047
            * */
            if (det.requested.name == 'jetty-webapp') {
                det.useVersion '9.4.51.v20230217'
            }

            /*
              CVE-2022-2048, CVE-2022-2047
            * */
            if (det.requested.name == 'jetty-xml') {
                det.useVersion '9.4.51.v20230217'
            }
        }
    }
}
