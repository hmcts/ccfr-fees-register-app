configurations.all {
    resolutionStrategy {
        eachDependency { DependencyResolveDetails det ->
            /* JAR upgrades with latest versions for CVE fixes*/

            /*
            * CVE-2020-11996, CVE-2020-13934, CVE-2020-13935, CVE-2020-13943,
            *  CVE-2020-17527, CVE-2020-8022, CVE-2020-9484
            * */
            if (det.requested.name == 'tomcat-embed-core') {
                det.useVersion '9.0.43'
            }

            if (det.requested.name == 'tomcat-embed-websocket') {
                det.useVersion '9.0.43'
            }

            /*
                CVE-2018-10237
            * */
            if (det.requested.name == 'guava') {
                det.useVersion '30.1-jre'
            }

            /*
                CVE-2008-1392, CVE-2009-0177, CVE-2009-0908, CVE-2009-1146, CVE-2009-1147, CVE-2009-1244, CVE-2009-1805
            * */
            if (det.requested.name == 'micrometer-core' && det.requested.group == 'io.micrometer') {
                det.useVersion '1.6.3'
            }

            /*
                CVE-2020-13956
            * */
            if (det.requested.name == 'httpclient') {
                det.useVersion '4.5.13'
            }

            /*
                CVE-2020-15250
            * */
            if (det.requested.name == 'junit' && det.requested.group == 'junit') {
                det.useVersion '4.13.1'
            }
            /* latest version CVE fix ends here */

            /* Build fails in the latest version, So taken the recent version with highest usages*/
            /*
                CVE-2020-25649
             */
            if (det.requested.name == 'jackson-databind') {
                det.useVersion '2.11.2'
            }

            /*
             CVE-2020-25638
           */
            if (det.requested.name == 'hibernate-core') {
                 det.useVersion '5.4.30.Final'
             }

            if (det.requested.name == 'spring-security-config') {
                det.useVersion '5.3.8.RELEASE'
            }
            if (det.requested.name == 'spring-security-core') {
                det.useVersion '5.3.8.RELEASE'
            }
            if (det.requested.name == 'spring-security-crypto') {
                det.useVersion '5.3.8.RELEASE'
            }
            if (det.requested.name == 'spring-security-web') {
                det.useVersion '5.3.8.RELEASE'
            }
            /* other CVE fix ends here */

            /* CVE-2021-22112 */
            if(det.requested.name == 'spring-security-config' || det.requested.name == 'spring-security-core' || det.requested.name == 'spring-security-crypto'
                    ||det.requested.name == 'spring-security-web'){
                det.useVersion '5.4.5'
            }

        }
    }
}
